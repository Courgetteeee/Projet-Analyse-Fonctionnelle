---
title: "Analyse Fonctionnelle"
author: "CARLU Jonas, AFANE Fouad, LANCON Cindy"
date: "2026-02-24"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  fig.align = "center",
  fig.width = 8,
  fig.height = 5
)

#packages
library(refund)
library(ggplot2)
library(mgcv)
library(lme4)
library(tidyr)
library(dplyr)
library(fda)
library(tidyverse)
library(cluster)
library(factoextra)
```

# Introduction

Ce projet a pour objectif d'étudier les profils de consommation électrique de $n = 6\,291$ entreprises, observées sur $D = 672$ instants de mesure espacés de 30 minutes sur deux semaines consécutives.

Contrairement à une analyse classique où nous traitons chaque instant de mesure serait traité comme une variable indépendante, nous considérons ici que chaque ligne du jeu de données correspond à une fonction de consommation évoluant dans le temps. Nous adaptons donc une approche d'Analyse de Données Fonctionnelles (FDA). L'analyse reposera sur trois étapes principales :

-   Reconstruction des courbes continues par lissage B-splines pénalisé.
-   Mise en oeuvre d'une Analyse en Composantes Principales Fonctionnelle (ACP fonctionnelle), afin de résumer la variabilité des courbes et d'identifier les principaux modes de variation des profils de consommation.
-   Classification des entreprises par clustering, afin de regrouper les consommateurs présentant des comportements similaires.

```{r}
#Chargement des données
chemin <- "donnees/smart278co.Rdata"
load(chemin)
table <- smart.278co

#Nb de lignes
n <- nrow(table)
#Nb de cols
p <- ncol(table)
#indices des mesures
time <- 1:p
```

# Exploration des données

Avant toute modélisation, on peut représenter des exemples des données brutes :

```{r}
#Afficher le profil du premier individu
ggplot() +
  geom_line(aes(x = time, y = as.numeric(table[1, ])), linewidth = 0.8) +
  theme_minimal() +
  labs(x = "Temps", y = "Consommation", title = "Profil individuel de consommation")
```

Les profils présentent une structure périodique marquée correspondant aux cycles journaliers. On observe des pics de consommation récurrents, probablement liés aux usages domestiques (matin, soir, weekends), ainsi qu’une variabilité notable entre individus.

Afin de synthétiser cette information, nous calculons ensuite la courbe moyenne et la courbe médiane, plus robuste aux profils atypiques.

```{r stats}
#Courbe moyenne et mediane
f_mean <- colMeans(table,  na.rm=T)
f_median <- apply(table, 2, median, na.rm=T)
```

```{r}
ggplot() +
  geom_line() +
  theme_minimal() + labs(x = "Temps", y = "Consommation")+
  #courbe moyenne
  geom_line(aes( x=time, y=f_mean, color="Moyenne"),
            linewidth = 1.1)+
  #courbe mediane
  geom_line(aes(x=time, y=f_median, color="Médiane"),
            linewidth = 1.1)+
  #Couleurs
  scale_color_manual(values = c("Moyenne"="blue", "Médiane"="purple"))+
  theme_minimal()+
  labs(title = "Consommation éléctrique moyenne et médiane", color="Courbe")
```

La courbe moyenne met clairement en évidence une structure périodique régulière.On observe clairement quatorze cycles journaliers successifs.

Chaque cycle présente une dynamique similaire : une phase de faible consommation nocturne suivie de pics plus marqués en journée, probablement associés aux usages domestiques (chauffage, cuisson, éclairage).

La stabilité de la forme moyenne suggère que la variabilité observée entre individus porte principalement sur l’amplitude des pics plutôt que sur la structure temporelle globale.

(Ajout vérification valeurs manquantes)

# Lissage semi-paramétrique
